<!DOCTYPE html>
<html>
<head>
  <meta name="robots" content="noindex">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    iframe {
      width: 100vw !important;
    }
    html, body, .twitter-tweet {
      margin: 0 !important;
    }
  </style>
  <script type="text/javascript">
    String.prototype.allReplace = function(obj) {
      var retStr = this;
      for (var x in obj) {
        retStr = retStr.replace(new RegExp(x, 'g'), obj[x]);
      }
      return retStr;
    };

    window.onload = function() {
      var urlParams = new URLSearchParams(window.location.search);
      var id = urlParams.get('id');

      var template = document.querySelector('template');
      var markup = template.innerHTML;
      markup = markup.allReplace({'tweet-id': id});
      document.body.innerHTML = markup;

      var script = document.createElement('script');
      script.src = 'https://platform.twitter.com/widgets.js';
      document.head.appendChild(script);

      var interval = setInterval(function() {
        var $element = document.querySelector('.twitter-tweet-rendered[data-tweet-id]');
        if (!$element) return;
        clearInterval(interval);

        var sizing = $element.getBoundingClientRect();
        sizing = JSON.parse(JSON.stringify(sizing));
        var tweetId = $element.dataset.tweetId;

        var myEvent = new CustomEvent(`twitter-embed-tweet-${tweetId}`, {
          sizing: sizing,
          tweetId: tweetId,
        });

        window.parent.dispatchEvent(myEvent)
      }, 0);
    };
  </script>
</head>
<body>
<template>
  <blockquote class="twitter-tweet">
    <a href="https://twitter.com/twitter/status/tweet-id">https://twitter.com/tweet/tweet-id</a>
  </blockquote>
</template>
</body>
</html>